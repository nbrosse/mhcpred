# MHCpred

This repository contains the code for a machine learning classifier that predicts whether a given peptide will be presented by a specific MHC class I protein, identified by its allele name. This project originated as an interview homework assignment. The data used for training and evaluation is derived from the training and evaluation data of NetMHCPan4.1, a well-established framework for MHC binding prediction but must remain **private**. This is a simplified version built within a limited timeframe.

Associated blog post: https://nbrosse.github.io/posts/mhc/mhc.html

## Installation

To install the `mhcpred` package:

1.  Ensure you have Poetry installed. If not, install it following the instructions on the [Poetry website](https://python-poetry.org/).

2.  Configure Poetry to use Python 3.9:

    ```bash
    poetry env use 3.9.*
    ```

3.  Activate the Poetry environment:

    ```bash
    poetry shell
    ```

    or

    ```bash
    poetry activate
    ```

4.  Install the project dependencies:

    ```bash
    poetry install
    ```

5.  **Configuration:**  It's crucial to configure the paths for your data, outputs, and models within the `settings.toml` file.  **Please modify the `settings.toml` file according to your directory structure.**  This step is essential for the scripts to function correctly.

The code structure and some components are inspired by the [mhcflurry package](https://github.com/openvax/mhcflurry).

## Notebooks

Two Jupyter notebooks are included:

-   `EDA.ipynb`:  Contains exploratory data analysis (EDA) to understand the data characteristics.
-   `metrics.ipynb`:  Analyzes the predictions generated by the model using various evaluation metrics.

## mhcflurry benchmark

To run the mhcflurry benchmark (for comparison purposes), follow the instructions on the [mhcflurry command-line tutorial](https://openvax.github.io/mhcflurry/commandline_tutorial.html):

1.  Download the necessary models:

    ```bash
    mhcflurry-downloads fetch models_class1_presentation
    ```

2.  Run the benchmark script:

    ```bash
    python scripts/mhcflurry_benchmark.py
    ```

## mhcpred scripts

```bash
python scripts/launch_training_inference.py
```
